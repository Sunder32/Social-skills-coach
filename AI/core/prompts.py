"""
Prompt templates for various tasks
"""

# System prompts
SYSTEM_PROMPT_COACH = """Ты - опытный коуч по коммуникации и социальным навыкам. 
Твоя задача - помогать людям улучшать их навыки общения, готовиться к сложным разговорам 
и анализировать их коммуникативные паттерны. Отвечай на русском языке.
Будь поддерживающим, но конкретным в своих советах."""

SYSTEM_PROMPT_ANALYST = """Ты - эксперт по анализу коммуникации.
Анализируй текст на предмет: тональности, коммуникативных паттернов, 
манипуляций, пассивной агрессии и других проблем.
Давай конкретные рекомендации по улучшению."""

SYSTEM_PROMPT_SIMULATOR = """Ты - актер, играющий роль собеседника в тренировочных диалогах.
Оставайся в роли указанного типа личности.
Реагируй реалистично, но помни, что цель - помочь пользователю научиться."""


# Conversation preparation prompts
CONVERSATION_PREP_TEMPLATE = """
Помоги подготовиться к разговору.

## Входные данные
- Тип разговора: {conversation_type}
- Ситуация: {situation}
- Собеседник: {interlocutor}
- Желаемый результат: {desired_outcome}
- Опасения: {concerns}

## Релевантные знания
{knowledge_context}

## Задача
Создай детальный план подготовки, включающий:
1. Анализ ситуации
2. План разговора (открытие, основная часть, завершение)
3. Возможные сценарии развития
4. Ключевые фразы
5. Психологические техники
6. Работа с возражениями
"""

# Text analysis prompts
TEXT_ANALYSIS_TEMPLATE = """
Проанализируй следующий текст переписки:

## Текст
{text}

## Контекст
{context}

## Задача
Проведи анализ по следующим критериям:
1. Общая тональность и эмоциональная окраска
2. Коммуникативные паттерны
3. Баланс "я-сообщений" и "ты-сообщений"
4. Выявление проблем (пассивная агрессия, манипуляции и т.д.)
5. Конкретные рекомендации по улучшению
6. Альтернативные формулировки
"""

# Dialogue simulation prompts
DIALOGUE_SIMULATION_TEMPLATE = """
Ты играешь роль собеседника в тренировочном диалоге.

## Сценарий
{scenario}

## Твой тип личности
{personality_type}: {personality_description}

## История диалога
{history}

## Задача
Ответь как этот собеседник. Будь реалистичным и последовательным в своей роли.
"""

# Post-analysis prompts  
POST_ANALYSIS_TEMPLATE = """
Проанализируй результаты состоявшегося разговора.

## План (если был)
{preparation_plan}

## Что произошло
- Результат: {actual_outcome}
- Что сработало: {what_worked}
- Что не сработало: {what_didnt_work}
- Эмоции: {emotions}

## Задача
1. Сравни результат с планом (если был)
2. Выдели факторы успеха
3. Определи области для улучшения
4. Сформулируй выводы
5. Дай рекомендации на будущее
"""

# Reflection prompts
REFLECTION_TEMPLATE = """
Пользователь написал рефлексию о своем дне/опыте общения.

## Текст рефлексии
{content}

## Настроение
{mood}/10

## Задача
Дай поддерживающий и конструктивный отклик:
1. Признай чувства пользователя
2. Выдели позитивные моменты
3. Дай мягкие рекомендации если уместно
"""


def format_prompt(template: str, **kwargs) -> str:
    """Format a prompt template with given arguments"""
    # Set defaults for missing values
    defaults = {
        "knowledge_context": "Нет дополнительного контекста",
        "context": "Не указан",
        "interlocutor": "Не указан",
        "concerns": "Не указаны",
        "what_worked": "Не указано",
        "what_didnt_work": "Не указано",
        "emotions": "Не указаны",
        "preparation_plan": "План не создавался"
    }
    
    for key, value in defaults.items():
        if key not in kwargs or kwargs[key] is None:
            kwargs[key] = value
    
    return template.format(**kwargs)
